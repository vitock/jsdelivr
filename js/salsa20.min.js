"use strict";var JSSalsa20=function(t,r){if(!(t instanceof Uint8Array)||32!==t.length)throw new Error("Key should be 32 byte array!");if(!(r instanceof Uint8Array)||8!==r.length)throw new Error("Nonce should be 8 byte array!");this.rounds=20,this.sigma=[1634760805,857760878,2036477234,1797285236],this.param=[this.sigma[0],this._get32(t,0),this._get32(t,4),this._get32(t,8),this._get32(t,12),this.sigma[1],this._get32(r,0),this._get32(r,4),0,0,this.sigma[2],this._get32(t,16),this._get32(t,20),this._get32(t,24),this._get32(t,28),this.sigma[3]],this.block=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.byteCounter=0};JSSalsa20.prototype._update=function(t){if(!(t instanceof Uint8Array)||0===t.length)throw new Error("Data should be type of bytes (Uint8Array) and not empty!");for(var r=new Uint8Array(t.length),s=0;s<t.length;s++)0!==this.byteCounter&&64!==this.byteCounter||(this._salsa(),this._counterIncrement(),this.byteCounter=0),r[s]=t[s]^this.block[this.byteCounter++];return r},JSSalsa20.prototype.encrypt=function(t){return this._update(t)},JSSalsa20.prototype.decrypt=function(t){return this._update(t)},JSSalsa20.prototype._counterIncrement=function(){this.param[8]=this.param[8]+1>>>0,0===this.param[8]&&(this.param[9]=this.param[9]+1>>>0)},JSSalsa20.prototype._salsa=function(){var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0,s=0;for(r=0;r<16;r++)t[r]=this.param[r];for(r=0;r<this.rounds;r+=2)t[4]=(t[4]^this._rotl(t[0]+t[12],7))>>>0,t[8]=(t[8]^this._rotl(t[4]+t[0],9))>>>0,t[12]=(t[12]^this._rotl(t[8]+t[4],13))>>>0,t[0]=(t[0]^this._rotl(t[12]+t[8],18))>>>0,t[9]=(t[9]^this._rotl(t[5]+t[1],7))>>>0,t[13]=(t[13]^this._rotl(t[9]+t[5],9))>>>0,t[1]=(t[1]^this._rotl(t[13]+t[9],13))>>>0,t[5]=(t[5]^this._rotl(t[1]+t[13],18))>>>0,t[14]=(t[14]^this._rotl(t[10]+t[6],7))>>>0,t[2]=(t[2]^this._rotl(t[14]+t[10],9))>>>0,t[6]=(t[6]^this._rotl(t[2]+t[14],13))>>>0,t[10]=(t[10]^this._rotl(t[6]+t[2],18))>>>0,t[3]=(t[3]^this._rotl(t[15]+t[11],7))>>>0,t[7]=(t[7]^this._rotl(t[3]+t[15],9))>>>0,t[11]=(t[11]^this._rotl(t[7]+t[3],13))>>>0,t[15]=(t[15]^this._rotl(t[11]+t[7],18))>>>0,t[1]=(t[1]^this._rotl(t[0]+t[3],7))>>>0,t[2]=(t[2]^this._rotl(t[1]+t[0],9))>>>0,t[3]=(t[3]^this._rotl(t[2]+t[1],13))>>>0,t[0]=(t[0]^this._rotl(t[3]+t[2],18))>>>0,t[6]=(t[6]^this._rotl(t[5]+t[4],7))>>>0,t[7]=(t[7]^this._rotl(t[6]+t[5],9))>>>0,t[4]=(t[4]^this._rotl(t[7]+t[6],13))>>>0,t[5]=(t[5]^this._rotl(t[4]+t[7],18))>>>0,t[11]=(t[11]^this._rotl(t[10]+t[9],7))>>>0,t[8]=(t[8]^this._rotl(t[11]+t[10],9))>>>0,t[9]=(t[9]^this._rotl(t[8]+t[11],13))>>>0,t[10]=(t[10]^this._rotl(t[9]+t[8],18))>>>0,t[12]=(t[12]^this._rotl(t[15]+t[14],7))>>>0,t[13]=(t[13]^this._rotl(t[12]+t[15],9))>>>0,t[14]=(t[14]^this._rotl(t[13]+t[12],13))>>>0,t[15]=(t[15]^this._rotl(t[14]+t[13],18))>>>0;for(r=0;r<16;r++)t[r]+=this.param[r],this.block[s++]=255&t[r],this.block[s++]=t[r]>>>8&255,this.block[s++]=t[r]>>>16&255,this.block[s++]=t[r]>>>24&255},JSSalsa20.prototype._get32=function(t,r){return t[r++]^t[r++]<<8^t[r++]<<16^t[r]<<24},JSSalsa20.prototype._rotl=function(t,r){return t<<r|t>>>32-r},"undefined"!=typeof module&&module.exports&&(module.exports=JSSalsa20);